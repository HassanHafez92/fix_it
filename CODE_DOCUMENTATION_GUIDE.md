# Code Documentation Standards for Fix It

## üìã Overview

This guide establishes documentation standards for the Fix It project to ensure code is maintainable, understandable, and follows best practices.

## üéØ Documentation Requirements

### 1. All Public Classes Must Have Documentation

```dart
/// Represents a user in the Fix It application.
///
/// This entity contains all user-related information including authentication
/// details, profile information, and user type classification.
///
/// The [UserEntity] supports two user types:
/// - `client`: Customers who book services
/// - `provider`: Service providers who offer services
///
/// Example:
/// ```dart
/// final user = UserEntity(
///   id: 'user123',
///   email: 'john@example.com',
///   fullName: 'John Doe',
///   userType: 'client',
///   createdAt: DateTime.now(),
///   updatedAt: DateTime.now(),
/// );
/// ```
class UserEntity extends Equatable {
```

### 2. All Public Methods Must Have Documentation

```dart
/// Authenticates a user with email and password.
///
/// Returns a [UserEntity] wrapped in [Either] on successful authentication,
/// or a [Failure] if authentication fails.
///
/// Common failure scenarios:
/// - Invalid email format
/// - Wrong password
/// - Network connection issues
/// - Account not found
///
/// Parameters:
/// - [email]: User's email address (must be valid format)
/// - [password]: User's password (minimum 6 characters)
///
/// Throws:
/// - [AuthenticationFailure] when credentials are invalid
/// - [NetworkFailure] when network is unavailable
///
/// Example:
/// ```dart
/// final result = await repository.signIn(
///   email: 'user@example.com',
///   password: 'password123',
/// );
/// result.fold(
///   (failure) => print('Error: $failure'),
///   (user) => print('Welcome ${user.fullName}'),
/// );
/// ```
Future<Either<Failure, UserEntity>> signIn({
  required String email,
  required String password,
}) async {
```

### 3. Complex Properties Need Documentation

```dart
class UserEntity extends Equatable {
  /// Unique identifier for the user.
  ///
  /// This ID is generated by Firebase Authentication and used
  /// as the primary key across all user-related operations.
  final String id;

  /// User's email address used for authentication.
  ///
  /// Must be a valid email format and is used as the primary
  /// authentication method along with password.
  final String email;

  /// Full display name of the user.
  ///
  /// Used throughout the app for personalization and display purposes.
  /// For providers, this name appears in service listings.
  final String fullName;

  /// Optional phone number for contact purposes.
  ///
  /// Required for service providers to enable customer communication.
  /// Format should include country code (e.g., +1234567890).
  final String? phoneNumber;

  /// User type classification: 'client' or 'provider'.
  ///
  /// Determines app behavior and available features:
  /// - 'client': Can browse and book services
  /// - 'provider': Can offer services and accept bookings
  ///
  /// This field is immutable after account creation.
  final String userType;

  /// Professional specialization for service providers.
  ///
  /// Required when [userType] is 'provider'. Defines the type of
  /// services the provider offers (e.g., 'plumbing', 'electrical').
  /// Must match one of the predefined service categories.
  final String? profession;
```

### 4. Use Cases Documentation Template

```dart
/// Signs in a user with email and password credentials.
///
/// This use case handles the complete sign-in flow including:
/// - Credential validation
/// - Firebase authentication
/// - User data retrieval from Firestore
/// - Error handling and mapping
///
/// **Business Rules:**
/// - Email must be in valid format
/// - Password must be at least 6 characters
/// - Account must exist and be verified
/// - User data must be present in Firestore
///
/// **Error Scenarios:**
/// - [InvalidCredentialsFailure]: Wrong email/password
/// - [NetworkFailure]: No internet connection
/// - [ServerFailure]: Firebase service unavailable
/// - [UserNotFoundFailure]: Account exists but no user data
///
/// **Dependencies:**
/// - [AuthRepository]: For authentication operations
///
/// Example usage:
/// ```dart
/// final signInUseCase = sl<SignInUseCase>();
/// final result = await signInUseCase(SignInParams(
///   email: 'user@example.com',
///   password: 'securePassword',
/// ));
/// ```
class SignInUseCase implements UseCase<UserEntity, SignInParams> {
  /// Repository for authentication operations.
  final AuthRepository repository;

  /// Creates a [SignInUseCase] with the required [repository].
  SignInUseCase(this.repository);

  @override
  Future<Either<Failure, UserEntity>> call(SignInParams params) async {
    // Validate input parameters
    if (!_isValidEmail(params.email)) {
      return Left(InvalidInputFailure('Invalid email format'));
    }

    if (params.password.length < 6) {
      return Left(InvalidInputFailure('Password too short'));
    }

    return await repository.signIn(
      email: params.email,
      password: params.password,
    );
  }

  /// Validates email format using RegExp.
  bool _isValidEmail(String email) {
    return RegExp(r'^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$').hasMatch(email);
  }
}

/// Parameters for the [SignInUseCase].
///
/// Encapsulates the required data for user sign-in operation.
class SignInParams {
  /// User's email address for authentication.
  final String email;

  /// User's password for authentication.
  final String password;

  /// Creates [SignInParams] with required [email] and [password].
  const SignInParams({
    required this.email,
    required this.password,
  });

  @override
  String toString() => 'SignInParams(email: $email, password: [HIDDEN])';
}
```

### 5. BLoC Documentation Standards

```dart
/// Manages authentication state for the Fix It application.
///
/// This BLoC handles all authentication-related operations including:
/// - User sign-in and sign-out
/// - Registration for clients and providers
/// - Password reset functionality
/// - Authentication state persistence
///
/// **State Flow:**
/// ```
/// AuthInitial ‚Üí AuthLoading ‚Üí AuthSuccess/AuthFailure
/// ```
///
/// **Events Handled:**
/// - [SignInRequested]: Authenticate with email/password
/// - [SignUpRequested]: Register new user account
/// - [SignOutRequested]: Log out current user
/// - [ForgotPasswordRequested]: Send password reset email
///
/// **Dependencies:**
/// - [SignInUseCase]: For user authentication
/// - [SignUpUseCase]: For user registration
/// - [SignOutUseCase]: For user logout
/// - [ForgotPasswordUseCase]: For password reset
class AuthBloc extends Bloc<AuthEvent, AuthState> {
```

## üö® Documentation Requirements Checklist

### For Every Class:
- [ ] Class-level documentation with purpose
- [ ] Usage examples when complex
- [ ] Dependencies and relationships
- [ ] Important behavioral notes

### For Every Public Method:
- [ ] Method purpose and behavior
- [ ] Parameter descriptions with constraints
- [ ] Return value explanation
- [ ] Exception scenarios
- [ ] Usage example for complex methods

### For Every Property:
- [ ] Purpose and usage
- [ ] Constraints and validation rules
- [ ] Relationship to other properties
- [ ] Nullability explanation when applicable

## üìù Documentation Templates

### Entity Template
```dart
/// Brief description of what this entity represents.
///
/// Detailed explanation of the entity's purpose and role in the domain.
/// Include any important business rules or constraints.
///
/// Example:
/// ```dart
/// // Usage example here
/// ```
class EntityName extends Equatable {
  /// Property description with constraints and usage.
  final Type propertyName;
}
```

### Use Case Template
```dart
/// Brief description of the business operation.
///
/// Detailed explanation including:
/// - Business rules
/// - Error scenarios
/// - Dependencies
///
/// Example:
/// ```dart
/// // Usage example
/// ```
class UseCaseName implements UseCase<ReturnType, ParamsType> {
}
```

### Repository Template
```dart
/// Abstract interface for [EntityName] data operations.
///
/// Defines the contract for data access operations related to [EntityName].
/// Implementations should handle both remote and local data sources.
///
/// Common implementations:
/// - [EntityNameRepositoryImpl]: Production implementation
/// - [MockEntityNameRepository]: Testing implementation
abstract class EntityNameRepository {
}
```

## üé® Code Comment Guidelines

### Inline Comments
```dart
// Use inline comments for complex logic explanation
final filteredProviders = providers.where((provider) {
  // Only show providers within 50km radius
  return calculateDistance(userLocation, provider.location) <= 50.0;
}).toList();

// Sort by rating descending, then by distance ascending
filteredProviders.sort((a, b) {
  final ratingComparison = b.rating.compareTo(a.rating);
  if (ratingComparison != 0) return ratingComparison;
  return calculateDistance(userLocation, a.location)
      .compareTo(calculateDistance(userLocation, b.location));
});
```

### TODO Comments
```dart
// TODO: Implement caching for frequently accessed user data
// TODO: Add retry mechanism for failed network requests
// FIXME: Handle edge case where user location is null
// HACK: Temporary workaround for Firebase timeout issue
```

## üîç Documentation Review Process

1. **Self Review**: Check your own documentation before PR
2. **Peer Review**: Team member reviews documentation quality
3. **Documentation Tests**: Ensure examples compile and work
4. **Regular Audits**: Monthly documentation quality reviews

## ‚ö° Tools and Automation

### VS Code Extensions
- Dart Documentation Generator
- Better Comments
- TODO Highlight

### Analysis Rules
Add to `analysis_options.yaml`:
```yaml
linter:
  rules:
    - public_member_api_docs
    - comment_references
    - prefer_doc_comments
```

## üìö Additional Resources

- [Effective Dart Documentation](https://dart.dev/guides/language/effective-dart/documentation)
- [Flutter Documentation Best Practices](https://flutter.dev/docs/development/tools/formatting)
- [Clean Code Documentation Principles](https://clean-code-developer.com/)
